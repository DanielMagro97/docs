(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{211:function(t,e,a){"use strict";a.r(e);var s=a(0),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"oasis-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#oasis-service","aria-hidden":"true"}},[t._v("#")]),t._v(" oasis.Service")]),t._v(" "),a("p",[a("code",[t._v("oasis.Service")]),t._v(" objects represent deployed services running on the Oasis cloud.")]),t._v(" "),a("h2",{attrs:{id:"constructor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#constructor","aria-hidden":"true"}},[t._v("#")]),t._v(" constructor")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("oasis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Service")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("idl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" address "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"parameters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parameters","aria-hidden":"true"}},[t._v("#")]),t._v(" Parameters")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("idl")]),t._v(" - "),a("code",[t._v("Idl")]),t._v(": The json idl defining the service interface")]),t._v(" "),a("li",[a("code",[t._v("address")]),t._v(" - "),a("code",[t._v("string | Uint8Array")]),t._v(": The address of the service.")]),t._v(" "),a("li",[a("code",[t._v("options")]),t._v(" - "),a("code",[t._v("Object")]),t._v(" (optional):")])]),t._v(" "),a("h3",{attrs:{id:"options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#options","aria-hidden":"true"}},[t._v("#")]),t._v(" options")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("gateway")]),t._v(" - "),a("a",{attrs:{href:"./gateways#OasisGateway"}},[t._v("OasisGateway")]),t._v(" (optional): The client backend to communicate with an oasis gateway")]),t._v(" "),a("li",[a("code",[t._v("db")]),t._v(" - "),a("code",[t._v("Db")]),t._v(" (optional): The persistent storage interface for the client's key manager.")])]),t._v(" "),a("h3",{attrs:{id:"returns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#returns","aria-hidden":"true"}},[t._v("#")]),t._v(" Returns")]),t._v(" "),a("p",[a("code",[t._v("Service")]),t._v(": A service object with all rpc endpoints attached.")]),t._v(" "),a("h2",{attrs:{id:"at"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#at","aria-hidden":"true"}},[t._v("#")]),t._v(" at")]),t._v(" "),a("p",[t._v("A more convenient api to attach to a previously deployed service is the "),a("code",[t._v("Service.at")]),t._v(" method, which will fetch the on-chain code and extract the idl automatically.")]),t._v(" "),a("p",[t._v("Note: this method should only be with oasis-rs services.")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" oasis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("at")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("address "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"parameters-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parameters-2","aria-hidden":"true"}},[t._v("#")]),t._v(" Parameters")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("address")]),t._v(" - "),a("code",[t._v("string | Unit8Array")]),t._v(": The address of the service to connect to.")]),t._v(" "),a("li",[a("code",[t._v("options")]),t._v(" - "),a("code",[t._v("Object")]),t._v(" (optional): The service deploy options. See above.")])]),t._v(" "),a("h3",{attrs:{id:"returns-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#returns-2","aria-hidden":"true"}},[t._v("#")]),t._v(" Returns")]),t._v(" "),a("p",[a("code",[t._v("Promise<Service>")]),t._v(": A promise resolving to a service object with all rpc endpoints attached.")]),t._v(" "),a("h2",{attrs:{id:"rpc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rpc","aria-hidden":"true"}},[t._v("#")]),t._v(" rpc")]),t._v(" "),a("p",[t._v("To make rpc requests to a service, invoke the rpc directly on the service object.\nFor example,")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Deployed service address.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" address "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Connects to the remote service.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("at")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("address"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Service specific rpc parameter.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" argument "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'this is an argument to a Service rpc'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RpcOptions.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" gasLimit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0xe79732'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Makes an rpc request to `myMethod` and returns the result.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" returnValue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("myMethod")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("argument"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("The client will ensure all Service api methods are camelCase, as is idiomatic JavaScript, even if your on-chain service uses snake_case, as is idiomatic Rust.")])]),t._v(" "),a("p",[t._v("The positional arguments for a given rpc should be passed directly into the method.\nIn addition, one can "),a("strong",[t._v("optionally")]),t._v(" specify "),a("code",[t._v("RpcOptions")]),t._v(".\nWhen used, these options must be the last argument given to a method.")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("When making RPCs to "),a("strong",[t._v("confidential")]),t._v(" services, one "),a("strong",[t._v("must")]),t._v(" specify the "),a("code",[t._v("gasLimit")]),t._v(" option.\nThe client can't estimiate the gas limit when state is confidential.")])]),t._v(" "),a("p",[t._v("A Service's method call returns only after the transaction has been finalized by the Oasis network.")]),t._v(" "),a("h3",{attrs:{id:"rpcoptions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rpcoptions","aria-hidden":"true"}},[t._v("#")]),t._v(" RpcOptions")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("gasLimit")]),t._v(" - "),a("code",[t._v("string")]),t._v(" | "),a("code",[t._v("number")]),t._v(" (optional): Gas limit to use for the transaction.")]),t._v(" "),a("li",[a("code",[t._v("value")]),t._v(" - "),a("code",[t._v("string")]),t._v(" | "),a("code",[t._v("number")]),t._v(" (optional): Value to send in the transaction.")]),t._v(" "),a("li",[a("code",[t._v("aad")]),t._v(" - "),a("code",[t._v("string")]),t._v(" (optional): Additional authenticated data exposed to the confidential runtime.")])]),t._v(" "),a("h2",{attrs:{id:"addeventlistener"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#addeventlistener","aria-hidden":"true"}},[t._v("#")]),t._v(" addEventListener")]),t._v(" "),a("p",[t._v("To listen to events emitted by the service, use the "),a("code",[t._v("addEventListener")]),t._v(" method.")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Received the event, '")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("An event is emitted only after the block containing it has been finalized by the Oasis network.")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("In the same way rpc method names are camelCase, event object keys are camelCase, even if the corresponding service is snake_case.")])]),t._v(" "),a("h3",{attrs:{id:"parameters-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parameters-3","aria-hidden":"true"}},[t._v("#")]),t._v(" Parameters")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("event")]),t._v(" - "),a("code",[t._v("String")]),t._v(": The name of the event.")]),t._v(" "),a("li",[a("code",[t._v("listener")]),t._v(" - "),a("code",[t._v("Listener")]),t._v(": A function taking a single event as a parameter.")])]),t._v(" "),a("h2",{attrs:{id:"removeeventlistener"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#removeeventlistener","aria-hidden":"true"}},[t._v("#")]),t._v(" removeEventListener")]),t._v(" "),a("p",[t._v("To stop listening to events emitted by the service, use the "),a("code",[t._v("removeEventListener")]),t._v(" method.\nIt's suggested to use this method to properly cleanup gateway subscriptions that result from creating event listeners.")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"parameters-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parameters-4","aria-hidden":"true"}},[t._v("#")]),t._v(" Parameters")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("event")]),t._v(" - "),a("code",[t._v("String")]),t._v(": The name of the event.")]),t._v(" "),a("li",[a("code",[t._v("listener")]),t._v(" - "),a("code",[t._v("Listener")]),t._v(": The listener function previously given to "),a("code",[t._v("addEventListener")]),t._v(".")])])])}),[],!1,null,null,null);e.default=n.exports}}]);